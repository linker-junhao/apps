var v=Object.defineProperty;var d=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var c=(t,a,e)=>a in t?v(t,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[a]=e,u=(t,a)=>{for(var e in a||(a={}))D.call(a,e)&&c(t,e,a[e]);if(d)for(var e of d(a))w.call(a,e)&&c(t,e,a[e]);return t};import{r as l,d as p,w as x,o as L,b as i,L as k,i as y,A as j,B as C,I as f,g as S,h as b,C as z}from"./vendor.b7d0e805.js";import{w as A}from"./index.2ab6f498.js";import{F as I}from"./index.91e3cfd3.js";import{r as g,w as h}from"./index.c115da1d.js";const K=()=>{const t=l({list:[],total:0});return{listData:t,append:(s,r)=>{t.list.push(...l(s)),t.total=r},flush:()=>{t.list.splice(0,t.list.length),t.total=0}}};var R=K;function B(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!y(t)}function F(){return p({name:"IdxList",props:["fetchListData","cellContentRender"],setup(t){const a=R(),e=l({finished:!1,loading:!1,error:!1}),s=l({page:1,pageSize:10}),r=async()=>{e.loading=!0,e.error=!1;try{const n=await t.fetchListData(s);a.append(n.list,n.total),s.pageSize>n.list.length&&(e.finished=!0)}catch{e.error=!0}e.loading=!1};x(()=>s,(n,o)=>{n.pageSize!==o.pageSize?(s.page=1,a.flush()):r()},{deep:!0});const m=()=>{!e.loading&&!e.error&&(s.page+=1),!e.loading&&e.error&&r()};return L(()=>{r()}),()=>{let n;return i(k,{"loading-text":"\u6B63\u5728\u52AA\u529B\u8F93\u51FA","finished-text":"\u6CA1\u6709\u66F4\u591A\u4E86...","error-text":"\u51FA\u9519\u4E86\u51FA\u9519\u4E86",finished:e.finished,loading:e.loading,"onUpdate:loading":o=>e.loading=o,onLoad:m,"immediate-check":!0},B(n=a.listData.list.map(o=>i("div",{key:o.key},[t.cellContentRender(o.data)])))?n:{default:()=>[n]})}}})}var q=p({name:"WorkList",setup(){const t=F(),a={extra:()=>i(f,{name:"chevron-right"},null)};return()=>i("div",null,[i(j,{title:"\u6211\u7684\u4F5C\u54C1"},{right:()=>i(C,{round:!0,text:!0,color:"transparent","text-color":"#ffffff",onClick:()=>{g.push({name:h.workAppend})}},{default:()=>[i(f,{name:"plus",size:24},null)]})}),i(t,{cellContentRender:e=>i("div",{onClick:()=>{g.push({name:h.workDetail,params:{workKey:e.id}})}},[S(i(z,null,u({default:()=>{var s;return[i("div",{class:"flex justify-start"},[i("div",null,[i(I,{class:"w-24",coverFileKey:((s=e.picKey)==null?void 0:s[0])||"",fileGroup:e.picKey},null)]),i("div",{class:"ml-2"},[i("div",null,[e.name]),i("div",null,[e.description])])])]}},a)),[[b("ripple")]])]),fetchListData:async()=>await A()},null)])}});export{q as default};
