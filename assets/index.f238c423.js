var I=Object.defineProperty,D=Object.defineProperties;var b=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable;var d=(a,e,t)=>e in a?I(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,l=(a,e)=>{for(var t in e||(e={}))V.call(e,t)&&d(a,t,e[t]);if(p)for(var t of p(e))v.call(e,t)&&d(a,t,e[t]);return a},i=(a,e)=>D(a,b(e));import{r as x,d as g,j as c,w as K,b as r,F as j,A as F,B as m,I as L,l as U,U as S,m as f,S as y,O as k,i as B,n as R,f as O}from"./vendor.b7d0e805.js";import{g as C,s as N,b as T,c as E}from"./index.2ab6f498.js";import{r as z,w as A}from"./index.c115da1d.js";import{w as h}from"./index.efaf0f26.js";const W=a=>{const e=x([]);return a.forEach((t,o)=>{C(t).then(n=>{if(n.file){const s=URL.createObjectURL(n.file);e[o]={url:s,name:t,file:n.file,fit:"cover",cover:s,state:"success"}}})}),e};function _(a){return typeof a=="function"||Object.prototype.toString.call(a)==="[object Object]"&&!B(a)}var P=g({name:"WorkEdit",props:{workKey:{type:String,required:!0}},setup(a){const e=c({name:"",id:""});K(()=>a.workKey,(o,n)=>{o&&o!==n&&E(o).then(s=>{var u;const w=W(((u=s.data)==null?void 0:u.picKey)||[]);e.value=i(l(l({},e.value),s.data||{name:"",id:""}),{picKey:w})})},{immediate:!0});const t=c();return{workInputData:e,formRef:t}},render(){let a;return r(j,null,[r(F,{title:"\u6DFB\u52A0\u6211\u7684\u4F5C\u54C1"},{right:()=>r(m,{round:!0,text:!0,color:"transparent","text-color":"#ffffff",onClick:()=>{z.push({name:A.workIndex})}},{default:()=>[r(L,{name:"format-list-checkbox",size:24},null)]})}),r("div",{class:"p-3"},[r(U,{ref:this.formRef},{default:()=>[r(S,{modelValue:this.workInputData.picKey,"onUpdate:modelValue":e=>this.workInputData.picKey=e,maxlength:6,maxsize:1024*1024,onBeforeRead:async e=>{if(e.file){const t=await N(e.file);if(t.file)return e.name=t.key,e.state="success",!0}return e.state="error",!1}},null),r(f,{placeholder:"\u8BF7\u8F93\u5165\u4F5C\u54C1\u540D",rules:[e=>!!e||"\u4F5C\u54C1\u540D\u4E0D\u80FD\u4E3A\u7A7A"],modelValue:this.workInputData.name,"onUpdate:modelValue":e=>this.workInputData.name=e},null),r(f,{placeholder:"\u4F5C\u54C1\u63CF\u8FF0",textarea:!0,rows:2,rules:[e=>!!e||"\u4F5C\u54C1\u540D\u4E0D\u80FD\u4E3A\u7A7A"],modelValue:this.workInputData.description,"onUpdate:modelValue":e=>this.workInputData.description=e},null),r(y,{placeholder:"\u9009\u62E9\u4F5C\u54C1\u7C7B\u578B",modelValue:this.workInputData.typeLayer1st,"onUpdate:modelValue":e=>this.workInputData.typeLayer1st=e,onChange:()=>{this.workInputData.typeLayer2nd=""}},_(a=h.options.map(e=>r(k,{key:e.value,label:e.label,value:e.value},null)))?a:{default:()=>[a]}),this.workInputData.typeLayer1st&&r(y,{placeholder:"\u9009\u62E9\u8BE6\u7EC6\u5206\u7C7B",modelValue:this.workInputData.typeLayer2nd,"onUpdate:modelValue":e=>this.workInputData.typeLayer2nd=e},{default:()=>{var e,t;return[(t=h.getOptionByValue(((e=this.workInputData)==null?void 0:e.typeLayer1st)||""))==null?void 0:t.children.map(o=>r(k,{key:o.value,label:o.label,value:o.value},null))]}})]}),r("div",{class:"mt-2"},[r(m,{block:!0,type:"primary",onClick:()=>{var e,t;((e=this.workInputData)==null?void 0:e.id)&&(T(this.workInputData.id,i(l({},this.workInputData),{picKey:(t=this.workInputData.picKey)==null?void 0:t.map(o=>o.name||"")})),R.success("\u4F5C\u54C1\u4FEE\u6539\u6210\u529F"))}},{default:()=>[O("\u4FDD\u5B58")]})])])])}});export{P as default};
