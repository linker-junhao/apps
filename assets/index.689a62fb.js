var I=Object.defineProperty,b=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var c=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var m=(a,e,t)=>e in a?I(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,l=(a,e)=>{for(var t in e||(e={}))v.call(e,t)&&m(a,t,e[t]);if(c)for(var t of c(e))x.call(e,t)&&m(a,t,e[t]);return a},i=(a,e)=>b(a,V(e));import{r as g,d as K,k as u,w as F,b as r,F as U,A as j,B as f,g as L,l as S,U as B,m as k,S as y,O as h,i as R,n as O,f as C}from"./vendor.ed1587f2.js";import{g as N,s as T,b as E,c as z}from"./index.2ab6f498.js";import{r as A,w as W}from"./index.5ae436b9.js";import{w}from"./index.efaf0f26.js";const _=a=>{const e=g([]);return a.forEach((t,o)=>{N(t).then(n=>{if(n.file){const s=URL.createObjectURL(n.file);e[o]={url:s,name:t,file:n.file,fit:"cover",cover:s,state:"success"}}})}),e};function q(a){return typeof a=="function"||Object.prototype.toString.call(a)==="[object Object]"&&!R(a)}var Q=K({name:"WorkEdit",props:{workKey:{type:String,required:!0}},setup(a){const e=u({name:"",id:""}),t=u(a.workKey);F(t,(n,s)=>{n&&n!==s&&z(n).then(p=>{var d;const D=_(((d=p.data)==null?void 0:d.picKey)||[]);e.value=i(l(l({},e.value),p.data||{name:"",id:""}),{picKey:D})})},{immediate:!0});const o=u();return{workInputData:e,formRef:o}},render(){let a;return r(U,null,[r(j,{title:"\u6DFB\u52A0\u6211\u7684\u4F5C\u54C1"},{right:()=>r(f,{round:!0,text:!0,color:"transparent","text-color":"#ffffff",onClick:()=>{A.push({name:W.workIndex})}},{default:()=>[r(L,{name:"format-list-checkbox",size:24},null)]})}),r("div",{class:"p-3"},[r(S,{ref:this.formRef},{default:()=>[r(B,{modelValue:this.workInputData.picKey,"onUpdate:modelValue":e=>this.workInputData.picKey=e,maxlength:6,maxsize:1024*1024,onBeforeRead:async e=>{if(e.file){const t=await T(e.file);if(t.file)return e.name=t.key,e.state="success",!0}return e.state="error",!1}},null),r(k,{placeholder:"\u8BF7\u8F93\u5165\u4F5C\u54C1\u540D",rules:[e=>!!e||"\u4F5C\u54C1\u540D\u4E0D\u80FD\u4E3A\u7A7A"],modelValue:this.workInputData.name,"onUpdate:modelValue":e=>this.workInputData.name=e},null),r(k,{placeholder:"\u4F5C\u54C1\u63CF\u8FF0",textarea:!0,rows:2,rules:[e=>!!e||"\u4F5C\u54C1\u540D\u4E0D\u80FD\u4E3A\u7A7A"],modelValue:this.workInputData.description,"onUpdate:modelValue":e=>this.workInputData.description=e},null),r(y,{placeholder:"\u9009\u62E9\u4F5C\u54C1\u7C7B\u578B",modelValue:this.workInputData.typeLayer1st,"onUpdate:modelValue":e=>this.workInputData.typeLayer1st=e},q(a=w.options.map(e=>r(h,{key:e.value,label:e.label,value:e.value},null)))?a:{default:()=>[a]}),this.workInputData.typeLayer1st&&r(y,{placeholder:"\u9009\u62E9\u8BE6\u7EC6\u5206\u7C7B",modelValue:this.workInputData.typeLayer2nd,"onUpdate:modelValue":e=>this.workInputData.typeLayer2nd=e},{default:()=>{var e,t;return[(t=w.getOptionByValue(((e=this.workInputData)==null?void 0:e.typeLayer1st)||""))==null?void 0:t.children.map(o=>r(h,{key:o.value,label:o.label,value:o.value},null))]}})]}),r("div",{class:"mt-2"},[r(f,{block:!0,type:"primary",onClick:()=>{var e,t;((e=this.workInputData)==null?void 0:e.id)&&(E(this.workInputData.id,i(l({},this.workInputData),{picKey:(t=this.workInputData.picKey)==null?void 0:t.map(o=>o.name||"")})),O.success("\u4F5C\u54C1\u4FEE\u6539\u6210\u529F"))}},{default:()=>[C("\u4FDD\u5B58")]})])])])}});export{Q as default};
